[{"title":"Jenkins使用NodeJS插件完成Vue的可持续集成","date":"2018-01-16T11:00:39.000Z","path":"2018/01/16/Jenkins_NodeJs_Vue_CI.html","text":"项目使用Vue做前端开发，故涉及到使用Jenkins做可持续集成，记录一下其中过程。 Jenkins的安装查看一下系统信息我使用的是DigitalOcean的服务器，系统版本CentOS 7.4.1708 x64。 安装Java1yum install java 查看一下java版本，应该安装的是openjdk的版本。gcj版本的java会导致jenkins不工作，JENKINS-7431234java -versionopenjdk version \"1.8.0_151\"OpenJDK Runtime Environment (build 1.8.0_151-b12)OpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode) 拉取Jenkins库配置到本地1sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo 导入公钥1sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key 安装Jenkins1sudo yum -y install jenkins yum真是好东西。 Jenkins配置文件及日志123cat /etc/sysconfig/jenkins | more #默认端口8080cd /var/lib/jenkins/logscat /var/log/jenkins/jenkins.log 启动服务1service jenkins start #停止 stop 访问Jenkinsurl:8080这里有个小坑，我的服务器上的8080端口被占用了，换了一个… 初始化Jenkins浏览器打开地址后，基本上按照页面提示就能完成初始化了，比如获取初始密码，安装插件等。 卸载Jenkins12rpm -e jenkinsfind / -iname jenkins | xargs -n 1000 rm -rf NodeJs编译Vue安装NodeJs插件Jenkins Dashboard -&gt; 系统管理 -&gt; 管理插件 -&gt; 可选插件过滤里选择NodeJs，勾选插件直接安装。 配置NodeJs插件Jenkins Dashboard -&gt; 系统管理 -&gt; 全局工具配置找到NodeJs节点，目前最新的LTS版本是8.9.4，选择对应版本安装即可。 新建jenkins任务Jenkins Dashboard -&gt; 新建任务，构建一个自由风格的软件项目。 选择github项目，vue的初始化项目，https://github.com/chen-c/test.git/。如果找不到GitBucket选项卡，去管理插件中安装下GitBucket插件。 源码管理中选择Git 构建环境中选择Provide Node&amp;npm bin/ folder to PATH，Installation中选择之前安装的NodeJs版本。新增一个构建步骤，选择Execute shell，简单的就先放两个命令。12npm installnpm run build 全部完成后保存应用一下。 立即构建点击立即构建，biu~ 编译完成后的vue就在服务器工作空间的dist文件夹里，后续可以在任务的构建后操作里增加一些复制打包等shell命令，就能完成自动部署等相关功能了。比如本hexo就由Jenkins自动打包并部署到DO上。 参考链接: https://segmentfault.com/a/1190000007086764https://www.cnblogs.com/vipzhou/p/7890016.html","categories":[{"name":"开发","slug":"开发","permalink":"https://www.chenchen.org/categories/开发/"}],"tags":[{"name":"前端","slug":"前端","permalink":"https://www.chenchen.org/tags/前端/"},{"name":"可持续集成","slug":"可持续集成","permalink":"https://www.chenchen.org/tags/可持续集成/"}]},{"title":"微信小程序wx.openLocation无效(iOS)","date":"2017-05-03T22:00:39.000Z","path":"2017/05/04/WeChat-Mini-Program-openLocation-tips.html","text":"微信小程序 wx.openLocation 位置api应该是一个lbs中非常常用的一个api，使用微信内置地图查看位置，经常与wx.getLocation接口一起使用，将用户定位到地图中心点。然而会发现有时候在iOS上会失效，到不了指定经纬度，安卓以及开发工具中都正常。 解决办法：尊重一下文档 wx.openlocationobject 会发现输入参数的经纬度类型是float，而iOS下似乎并没有对输入项做转换，因此需要自己做一下转换。 request里的经纬度做如下处理即可： lat = parseFloat(lat); PS：所以，要尊重下文档对吧，如支付宝般：）","categories":[{"name":"开发","slug":"开发","permalink":"https://www.chenchen.org/categories/开发/"}],"tags":[{"name":"踩坑","slug":"踩坑","permalink":"https://www.chenchen.org/tags/踩坑/"},{"name":"微信","slug":"微信","permalink":"https://www.chenchen.org/tags/微信/"}]},{"title":"新年","date":"2017-02-04T22:45:17.000Z","path":"2017/02/05/newyear-2017.html","text":"每到新年伊始，都会有总结过去展望未来的念头，充满着仪式感。仪式感，虽可以被归为形式主义，但不可否认的，它带给我们对生活更多的期望。 过去的2016，坎坷而悠长。但至少完成了一个小目标，坚持自己做早饭，也证明了老人们的教诲-“习惯成自然”。每日清晨早起，挽留一点时间，做一份早餐，看一段新闻，也是一种仪式感的存在。在厨子这条道路上，我迈出了小小的一步。 吸取多年的教训，2017的目标并不会很宏大。毕竟，这是自己的生活，而非冠冕之堂的展望。 多看几本书，虽然达不到一周一本，但我希望先能达成每月一书的里程碑。 继续在厨子的道路上前行，保持自己做饭的习惯。 增加一种技能，也许是一门语言，也许是一门新学科，也许是手工活。 开始一场旅行，因为各种原因，已经两年多没有了。 始终保持微笑前行，爱我的家人和朋友。","categories":[{"name":"生活","slug":"生活","permalink":"https://www.chenchen.org/categories/生活/"}],"tags":[{"name":"新年","slug":"新年","permalink":"https://www.chenchen.org/tags/新年/"}]},{"title":"2013.1.4","date":"2013-01-04T00:00:00.000Z","path":"2013/01/04/2013.1.4.html","text":"在对末日的好奇和期待中，2012过去了。2013如约而至，也许大家都喜欢用重生来形容这一年。所有人都希望能有一次重生重新开始的机会，很可惜那只存在于WOW中，这是一列渐行渐远的绿皮火车，你永远无法预知那些人从哪来在哪下，每一次见面也许都是最后一面。正如少年派中的那句话：“人生也许就是不断地放下，然而令人痛心的是，我都没能好好地与他们道别”。用心对待每一天的人和事吧，毕竟，这没有重来的机会。 2013.1.4，传说中的爱你一生一世，也是我又一岁的新开始。这一天，杭州漫天飞雪；这一天，生活又将开始。","categories":[{"name":"生活","slug":"生活","permalink":"https://www.chenchen.org/categories/生活/"}],"tags":[{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"},{"name":"新年","slug":"新年","permalink":"https://www.chenchen.org/tags/新年/"}]},{"title":"祭一年","date":"2009-11-15T23:00:00.000Z","path":"2009/11/16/One-year.html","text":"窗外冬雨沥沥，我蜷缩着坐在电脑前，杭州的冬天真不是一般的冷，阴，冷，湿交织在一起，构成了杭州的冬天，也许杭州的风景能称之为天堂，但环境绝对配不上天堂的名号。夏天的酷热，冬天的阴冷，永远灰蒙蒙的天空和拥堵的交通，他远远还没有达到一个宜居城市的标准，只因为他是省会。 看着日历，突然想起了去年的这个时候。那时候，11月和12月，正是我在四处奔波的日子，从温州跑到杭州又去了宁波还到了北京又回了宁波再上杭州最后回温州，冗长而又乏味的旅途，为了工作奔波，为了前途奔波。好多次跨过整个浙江来到杭州参加各种面试，等来的都是杳无音信。跑到宁波却又被告知考试取消，终于还是去了北京放了一星期假，四处游玩了一下，虽然目的是去比赛，但这对我已经不再重要。 记得2007年，我带着兴奋第一次来到了北京，四周闲逛，果然毛主席脚下，一切太平和谐，一个铜板都能让我吃得心满意足。2008年，当我再次回到这片土地的时候，带着一丝回忆和惆怅，总算登上了长城，在瑟瑟寒风中，吃了一碗兰州拉面就搞定了一切。当时间跑到2009年时，我已经不会再回到那里，穿着登上长城的装备坐在电脑前，却发现这里比长城之巅更加之冷。 昨天看到一句话，以后再也没有同桌了。恩，高中之后，已无同桌；大学之后，也已失去了最真的校园。","categories":[{"name":"生活","slug":"生活","permalink":"https://www.chenchen.org/categories/生活/"}],"tags":[{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"},{"name":"乱弹","slug":"乱弹","permalink":"https://www.chenchen.org/tags/乱弹/"}]},{"title":"彼岸花","date":"2009-01-23T23:00:00.000Z","path":"2009/01/24/bi_an_hua.html","text":"花开彼岸本无岸魂落忘川犹在川醉里不知烟波浩梦中依稀灯火寒花叶千年不相见缘尽缘生舞翩迁花不解语花颔首佛渡我心佛空叹","categories":[{"name":"生活","slug":"生活","permalink":"https://www.chenchen.org/categories/生活/"}],"tags":[{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"},{"name":"乱弹","slug":"乱弹","permalink":"https://www.chenchen.org/tags/乱弹/"}]},{"title":"明月千年，三秋之半","date":"2008-09-14T14:54:00.000Z","path":"2008/09/14/ming_yue_qian_nian_san_qiu_zhi_ban.html","text":"今天是农历八月十五，即三秋之半，中秋节。自从上了大学，因为家离学校比较远，中秋基本上都是在学校里过的，虽说现在中秋的意义没有过去那么大，但秋天向来是用来伤感的。秋天除了丰收，更多的是秋风下的伤感。今年中秋，本来想酸一下去屋顶赏个月，喝个小酒（可乐也行），吹吹秋风，忆个往昔之类的，结果赶上了台风，吹秋风的愿望倒是让非常满足的实现了。也不知道为什么，今天晚上的胃口相当好，因为下暴雨，先在寝室吃了一碗多多妙，接着雨停了，非常不爽，出去吃了烤翅、炒饭，又带了两个香蕉慢慢消灭了，在阳台望了会月，我坚信心中有月，就有月。再然后又去吃了果冻、炒粉干，到超市买了瓶百事，全数消灭。晚上爸爸打了个电话来，问候了一声，聊了会家常，妈妈去了云南旅游，应该正玩得开心。这学期准备积点私房钱也去趟云南玩玩，还准备入手一台thinkpad，任务还是比较艰巨的。看着窗外，突然想到了大一的暑假，xman、小超、胖子、我，半夜十二点，躺在信息楼前的小平台，一起唱歌，一起疯，转眼，已经三年了。在过不久，我也许就要离开这个学校，或许，也要结束我的学生生涯了。明月千年，静看人间，阴晴圆缺，三秋之半。S哥刚刚看中了一个巫妖王的手工戒指，继续乐此不疲。寝室貌似有活动，先到这里吧，上了大学，感性思维弱了很多-_-!!最后祝大家中秋快乐，合家团圆:)","categories":[{"name":"生活","slug":"生活","permalink":"https://www.chenchen.org/categories/生活/"}],"tags":[{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"},{"name":"中秋","slug":"中秋","permalink":"https://www.chenchen.org/tags/中秋/"}]},{"title":"Paypal国际版网站集成简易教程（三）：IPN的使用","date":"2008-07-17T12:10:00.000Z","path":"2008/07/17/Paypal_integrated_3.html","text":"什么是即时付款通知IPN当您收到新的付款交易或者已发生的付款交易的状态发生变化时，PayPal都将异步（即不作为网站付款流程的一部分） 发送付款详细数据到您所指定的URL，以便您了解买家付款的具体情况并做出相应的响应。这个过程我们称作即时付款通知（简称 IPN）。 最近事情比较多，一直没有继续更新，不好意思了，今天难得有空，就把最重要的一段先发上来了。相信大部分网站集成Paypal都希望能够实现客户支付完成后返回信息到自己的网站，然后处理这些信息。比如客户在你的网站上购买了一个产品，通过Paypal完成了支付，接着Paypal告诉你的网站客户完成了支付以及支付信息，最后你的网站将这些信息记录到你自己的数据库中，并且将你的客户订单状态设为已支付，接着你就可以进行一系列的相关订单的后续操作。IPN就能帮助我们实现这个功能，IPN示意图如下（来自Paypal.com）： 当客户完成支付，Paypal会在后台通过post方式向你的服务器传送交易数据，来实现网站集成的功能。接下来我们就来看IPN的实现方法。第一步，你需要一个sandbox的帐号，这很重要，因为它能让你随心所欲的进行测试，而不用担心资金在天上飞。注册地址：https://developer.paypal.com第二步，登陆sandbox，新建一个商家帐号（卖方）和一个客户账号（买方），其中卖方帐号必须是Premier或者Business，不然无法使用IPN功能。 新建买家帐号的时候记得在Account Balance中加上金额，不然你就没钱买东西了，如果paypal.com的帐号也能这样加钱多好。新建完两个帐号： 卖家帐号的test mode要设为enabled。选中business帐号，点击下面的Enter Sandbox Test Site进入sandbox Test Site，登录，就像普通Paypal帐号的管理页面一样。 点击Profile，在Selling Preferences中选择Instant Payment Notification Preferences，点击edit加入IPN信息返回的地址，记得勾上前面那个选项，我是用.net写的接受文件，所以我的IPN地址是http://www.chenchen.org/ipn.aspx ,地址只要能在互联网上访问到就可以了。 在Profile -&gt; Selling Preferences -&gt;Website Payment Preferences选项中，有一个Auto Return的选项，将它设为on，并且在下面的return地址中填入你希望的客户支付完成后返回的地址：以上就完成了商家端的设置。 接下来是你网站上ipn.aspx文件的编写，这个是用来接收支付数据的，是非常关键的一个文件。文件环境，.net 2.0，语言C#。Ipn.aspx文件：此文件不用修改任何东西，代码都在cs文件中。Ipn.aspx.cs文件：关键代码定义一个VerifyIPN()函数： 1234567891011121314151617181920212223bool VerifyIPN() &#123; string strFormValues = Request.Form.ToString(); string strNewValue; string strResponse; string serverURL = \"https://www.sandbox.paypal.com/cgi-bin/webscr\"; HttpWebRequest req = (HttpWebRequest)WebRequest.Create(serverURL); req.Method = \"POST\"; req.ContentType = \"application/x-www-form-urlencoded\"; strNewValue = strFormValues + \"&amp;cmd;=_notify-validate\"; req.ContentLength = strNewValue.Length; StreamWriter stOut = new StreamWriter(req.GetRequestStream(), System.Text.Encoding.ASCII); stOut.Write(strNewValue); stOut.Close(); StreamReader stIn = new StreamReader(req.GetResponse().GetResponseStream()); strResponse = stIn.ReadToEnd(); stIn.Close(); return strResponse == \"VERIFIED\";&#125; 这段代码的作用是判断IPN信息是否来自Pyapal，如果不进行判断，那么恶意用户完全可以模拟一个信息post到你的网站上，让你认为订单已经完成支付，所以，必须首先对接受到的信息进行验证。代码的基本原理，serverURL定义了验证地址，sandbox为：https://www.sandbox.paypal.com/cgi-bin/webscr，Paypal.com就是https://www.paypal.com/cgi-bin/webscr。将paypal发送过来的所有信息加上一个&cmd;=_notify-validate参数，表示对这个信息进行验证，全部发送回paypal验证，如果信息确实存在，则返回VERIFIED字符串。验证成功后，就可以用如下形式获得交易信息： 1234567891011121314151617public partial class paypal_ipn : System.Web.UI.Page&#123; protected void Page_Load(object sender, EventArgs e) &#123; if (VerifyIPN())//验证成功 &#123; string ppTx = Request.Form[\"txn_id\"].ToString();//获取post中的各项变量值 … 执行将数据写入数据库等操作 &#125; &#125; bool VerifyIPN()&#123; 具体代码见上。 &#125;&#125; 这样，就实现了将支付信息传回网站的功能。注：当交易状态发生改变时，paypal也会返回一个ipn，比如完成支付，退款等等。 介绍一下sandbox中IPN测试工具，登陆sandbox主帐号，就是你在sandbox上注册的那个，不是那些卖家/买家帐号。选择Test Tools -&gt; Instant Payment Notification (IPN) Simulator：输入你的ipn接受文件地址，选择ipn信息的方式，然后会让你填具体信息内容，再点击Send IPN，就能模拟一个ipn到你网站的页面，可以用来测试IPN是否正常工作。 不过这个工具有个小BUG，就是发送的IPN里不包括contact_phone这个变量，但是实际的IPN里是有的，这里要注意一下。注：可以在商家帐号的Profile -&gt; Selling Preferences -&gt;Website Payment Preferences中，选择Contact Telephone Number这一栏，来确定是否需要发送买家联系电话。 此文来自时光旅行，内容已不维护:)","categories":[{"name":"开发","slug":"开发","permalink":"https://www.chenchen.org/categories/开发/"}],"tags":[{"name":"Paypal","slug":"Paypal","permalink":"https://www.chenchen.org/tags/Paypal/"},{"name":"踩坑","slug":"踩坑","permalink":"https://www.chenchen.org/tags/踩坑/"},{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"}]},{"title":"Paypal国际版网站集成简易教程（二）：快速加入支付按钮","date":"2008-07-10T11:15:00.000Z","path":"2008/07/10/Paypal_integrated_2.html","text":"本篇主要介绍如何在你的网站上快速加入paypal支付按钮，通过这个按钮，人们可以方便快速的付款到你的paypal帐户。首先，你需要注册一个paypal帐户，帐户类型分为Personal（个人）、Premier（高级）和Business（商业），他们的差别对于开发者来说主要是返回的信息，Personal的不能使用IPN和PDT等商家工具，即不能获取交易信息，但是Personal帐户收款无需手续费；Premier和Business当然就提供了IPN和PDT功能，能够在客户支付成功后，将交易信息传给指定的网站，用来二次使用。Premier和Business使用上的差异我不是很清楚，应该是月收款额和手续费上的区别吧。 这里插进来介绍一下paypal sandbox，也就是沙盒，是paypal提供给开发者的一个工具，非常好用，你可以在https://developer.paypal.com/ 注册和使用它。登录以后可以新建帐户，设置余额和帐户类型，有一点要注意，每次使用时必须先登录sandbox才能使用新建的那些帐户。Sndbox里面有个测试工具，可以发送IPN的，以后会用到。 接着上面的内容，注册完帐户以后，当然，一开始开发最好使用sandbox，不然资金转来转去手续费都扣光了，paypal的费率如下：商家收费比起国内的支付工具，paypal贵了好多，当然，和国情也有关系。接下来是按钮的代码，很简单，就是一个普通的网页表单代码： &lt;form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\"&gt; &lt;input type=\"hidden\" name=\"cmd\" value=\"_xclick\"&gt; &lt;input type=\"hidden\" name=\"business\" value=\"sample@sample.com\"&gt; &lt;input type=\"hidden\" name=\"item_name\" value=\"Item Name Goes Here\"&gt; &lt;input type=\"hidden\" name=\"item_number\" value=\"Item Number Goes Here\"&gt; &lt;input type=\"hidden\" name=\"amount\" value=\"100.00\"&gt; &lt;input type=\"hidden\" name=\"no_shipping\" value=\"2\"&gt; &lt;input type=\"hidden\" name=\"no_note\" value=\"1\"&gt; &lt;input type=\"hidden\" name=\"currency_code\" value=\"USD\"&gt; &lt;input type=\"hidden\" name=\"bn\" value=\"IC_Sample\"&gt; &lt;input type=\"image\" src=\"https://www.paypal.com/ en_US/i/btn/x-click-but23.gif\" name=\"submit\" alt=\"Make payments with payPal - it's fast, free and secure!\"&gt; &lt;img alt=\"\" src=\"https://www.paypal.com/en_US/i/scr/pixel.gif\" width=\"1\" height=\"1\"&gt; &lt;/form&gt; 如果使用sandbox，action地址改成https://www.sandbox.paypal.com/cgi-bin/webscr即可，上面这段还是很容易理解的，看下name和value基本上就能知道每个值的含义了。保存用浏览器打开，就会看到一个paypal的按钮，点击过去按照提示操作，就能付款到business指定值的帐户了。这就是一个最简单的paypal支付按钮。再下一篇中会讲一下如何在付款成功之后，将信息返回到你的网站，大部分需求都是客户完成付款后返回信息到网站的数据库，记录网站客服的交易信息。最后稍微了解下为什么海外用户喜欢用自己的网站做生意，而不是像国内一样用淘宝之类的C2C平台。一开始我也很不理解，有免费的平台为什么要自己建设网站还要支付paypal的手续费，后来和客户了解了一下，他们做的事网游虚拟交易，国外最大的C2C平台就是eBay，但只有德国可以售卖虚拟物品，并且eBay上的交易并不是免费的，收取的手续费远远高于paypal的费率，因此，更多的海外用户选择自己建设网站进行电子商务。 此文来自时光旅行，内容已不维护:)","categories":[{"name":"开发","slug":"开发","permalink":"https://www.chenchen.org/categories/开发/"}],"tags":[{"name":"Paypal","slug":"Paypal","permalink":"https://www.chenchen.org/tags/Paypal/"},{"name":"踩坑","slug":"踩坑","permalink":"https://www.chenchen.org/tags/踩坑/"},{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"}]},{"title":"Paypal国际版网站集成简易教程（一）：序言","date":"2008-07-09T12:10:00.000Z","path":"2008/07/09/Paypal_integrated_1.html","text":"前段时间接到一个外贸网站的项目，集成paypal支付接口的，对象是海外用户，全部用US的信用卡结算。国内有个paypal的中文版，叫贝宝，不过只支持人民币之间的结算，而且提供的功能不多。所以只能使用paypal国际版，也就是paypal.com，习惯性的google了一下相关资料，发现关于paypal.com接口的中文文档并不多，也不详细，只好自己上paypal.com研究，还好paypal上的资料非常齐全，而且还提供了开发者沙盒（sandbox），相比之下，国内流行的支付宝还有很长的路要走啊。 项目结束的时候就有想法写一篇网站集成paypal的简易教程，方便以后的各位开发者，毕竟看长篇英文资料是很头痛的事情^_^。一直到昨天期末考才结束，所以今天开始写这个教程，其实内容也不多，可能还算不上教程，只能算经验吧。 主要分为序言、支付按钮、返回信息方式（IPN&PDT;）、实例四部分组成，预计在三天内完成，如果有新内容我临时再加吧。接下来一篇将会介绍如何在网站上快速加入paypal支付按钮。 此文来自时光旅行，内容已不维护:)","categories":[{"name":"开发","slug":"开发","permalink":"https://www.chenchen.org/categories/开发/"}],"tags":[{"name":"Paypal","slug":"Paypal","permalink":"https://www.chenchen.org/tags/Paypal/"},{"name":"踩坑","slug":"踩坑","permalink":"https://www.chenchen.org/tags/踩坑/"},{"name":"时光旅行","slug":"时光旅行","permalink":"https://www.chenchen.org/tags/时光旅行/"}]}]